Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react");function _interopDefaultLegacy(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var React__default=_interopDefaultLegacy(React);exports.IntegrationType=void 0,function(e){e.Gigya="gigya",e.Firebase="firebase"}(exports.IntegrationType||(exports.IntegrationType={})),exports.WidgetType=void 0,function(e){e.Register="register",e.Login="login",e.Recover="recover"}(exports.WidgetType||(exports.WidgetType={})),exports.WidgetPosition=void 0,function(e){e.Start="start",e.End="end"}(exports.WidgetPosition||(exports.WidgetPosition={})),exports.Position=void 0,function(e){e.Top="top",e.Bottom="bottom",e.Start="start",e.End="end"}(exports.Position||(exports.Position={})),exports.InlineWidgetVariants=void 0,function(e){e.Button="button",e.ButtonFingerprint="button-fingerprint",e.ButtonFaceID="button-faceid",e.ClientButton="client-button",e.OwnidAuthButton="ownid-auth-button"}(exports.InlineWidgetVariants||(exports.InlineWidgetVariants={}));class OwnidService{constructor(){this.language="en"}init(e){this.addSdkScript(e),window.ownid("init",e)}setConfig(e){window.ownid("init",e)}setLanguage(e){this.language=e}getLanguage(){return this.language}render(e){return window.ownid("render",e)}reRender(e,n){return window.ownid("reRender",e,n)}destroy(e){return window.ownid("destroy",e)}login(e){return window.ownid("login",e)}register(e){return window.ownid("register",e)}recover(e){return window.ownid("recover",e)}getOwnIDData(e){return window.ownid("getOwnIDData",e)}addOwnIDConnection(e,n){return window.ownid("addOwnIDConnectionOnServer",e,n)}enrollDevice(){return window.ownid("enrollDevice")}addSdkScript(t){if(!window.ownid){window.ownid=function(){return(window.ownid.q=window.ownid.q||[]).push(arguments),Promise.resolve({error:null,data:null})};let e="https://cdn.ownid.com/js/sdk.js",n=t.env?t.env+".":"";if(t.appId&&(e=`https://cdn.${n}ownid.com/sdk/`+t.appId),t.serverUrl){const r=t.serverUrl.split("/")[2],d=r.split(".");var i=d.indexOf("server");n="ownid"!==d[i+1]?d[i+1]+".":"",e=`https://cdn.${n}ownid.com/sdk/`+d[0]}const o=document.createElement("script");return o.src=t.overrideSdk||e,o.async=!0,document.head.appendChild(o),()=>{document.head.removeChild(o)}}}}class OwnidReactService extends OwnidService{}const ownidReactService=new OwnidReactService,OwnIDInit=({config:e})=>(React.useEffect(()=>ownidReactService.init(e),[]),null),OwnID=n=>{const t=React.useRef(null),{type:i,passwordField:o,loginIdField:r,targetElement:d,targetField:a,confirmPasswordContainer:s,language:c,passwordToggle:w,options:u,onLogin:l,onRegister:g,onError:p}=n;return React.useEffect(()=>{var e=Object.assign(Object.assign({element:t.current,type:i,passwordField:null===o||void 0===o?void 0:o.current,loginIdField:null===r||void 0===r?void 0:r.current,confirmPasswordContainer:null===s||void 0===s?void 0:s.current,targetElement:null===d||void 0===d?void 0:d.current,targetField:null===a||void 0===a?void 0:a.current,language:c||ownidReactService.getLanguage(),passwordToggle:w},u),{onLogin:l,onRegister:g,onError:p});return ownidReactService.setConfig({onMagicLink:n.onLogin,onMagicLinkError:n.onError}),ownidReactService[n.type](e),()=>ownidReactService.destroy(n.type)},[null===l||void 0===l?void 0:l.toString(),null===g||void 0===g?void 0:g.toString(),null===p||void 0===p?void 0:p.toString(),i,o,r,s,d,a,c,w,JSON.stringify(u)]),React__default.default.createElement("div",{ref:t})};exports.OwnID=OwnID,exports.OwnIDInit=OwnIDInit,exports.ownidReactService=ownidReactService;
